<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Command Center - TV Fullscreen</title>
    
    <!-- 1. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Prop-types -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prop-types/15.8.1/prop-types.min.js"></script>
    
    <!-- 4. Recharts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.12.7/Recharts.min.js"></script>

    <!-- 5. Babel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

    <style>
        html, body, #root {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #0f172a; /* slate-900 */
            color: #ffffff;
        }
        ::-webkit-scrollbar { display: none; }
        * { -ms-overflow-style: none; scrollbar-width: none; }
        .cell-truncate { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 6px; }
        .status-dot.live { background-color: #10b981; box-shadow: 0 0 8px #10b981; }
        .status-dot.mock { background-color: #f59e0b; animation: blink 2s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    </style>
</head>
<body>
    <div id="root" class="h-screen w-screen bg-slate-900 flex items-center justify-center text-slate-500">
        로딩 중... (잠시만 기다려주세요)
    </div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        // --- 아이콘 컴포넌트 ---
        const Icon = ({ children, size = 16, className = "", color = "currentColor", onClick }) => (
            <svg onClick={onClick} xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Icons = {
            LayoutDashboard: (p) => <Icon {...p}><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></Icon>,
            RefreshCw: (p) => <Icon {...p}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></Icon>,
            Settings: (p) => <Icon {...p}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></Icon>,
            Briefcase: (p) => <Icon {...p}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></Icon>,
            Layers: (p) => <Icon {...p}><path d="m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z"/><path d="m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65"/><path d="m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65"/></Icon>,
            DollarSign: (p) => <Icon {...p}><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></Icon>,
            Crown: (p) => <Icon {...p}><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></Icon>,
            Edit: (p) => <Icon {...p}><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></Icon>,
            X: (p) => <Icon {...p}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></Icon>,
            Plus: (p) => <Icon {...p}><path d="M5 12h14"/><path d="M12 5v14"/></Icon>,
            Trash: (p) => <Icon {...p}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></Icon>,
            Save: (p) => <Icon {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></Icon>,
            Target: (p) => <Icon {...p}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></Icon>,
            Building: (p) => <Icon {...p}><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><path d="M9 22v-4h6v4"/><path d="M8 6h.01"/><path d="M16 6h.01"/><path d="M8 10h.01"/><path d="M16 10h.01"/><path d="M8 14h.01"/><path d="M16 14h.01"/></Icon>,
            Eye: (p) => <Icon {...p}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></Icon>,
            Check: (p) => <Icon {...p}><polyline points="20 6 9 17 4 12"/></Icon>,
            AlertTriangle: (p) => <Icon {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></Icon>,
            Lock: (p) => <Icon {...p}><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></Icon>
        };

        // --- 유틸리티 ---
        const parseCSV = (str) => {
            const arr = [];
            let quote = false;
            let col = 0, row = 0;
            arr[row] = arr[row] || [];
            arr[row][col] = arr[row][col] || '';
            for (let c = 0; c < str.length; c++) {
                let cc = str[c], nc = str[c+1];
                if (cc === '"' && quote && nc === '"') { arr[row][col] += cc; ++c; continue; }
                if (cc === '"') { quote = !quote; continue; }
                if (cc === ',' && !quote) { ++col; arr[row][col] = ''; continue; }
                if (cc === '\r' && nc === '\n' && !quote) { ++row; col = 0; ++c; arr[row] = []; continue; }
                if (cc === '\n' && !quote) { ++row; col = 0; arr[row] = []; continue; }
                if (cc === '\r' && !quote) { ++row; col = 0; arr[row] = []; continue; }
                arr[row][col] += cc;
            }
            return arr;
        };

        const parseCurrency = (str) => {
            if (!str) return 0;
            if (typeof str !== 'string' && typeof str !== 'number') return 0;
            const s = String(str).trim();
            if (s.startsWith('#')) return 0; 
            const cleanStr = s.replace(/[^0-9.-]/g, '');
            const num = parseFloat(cleanStr);
            return isNaN(num) ? 0 : Math.floor(num);
        };

        const formatKoreanCurrency = (val) => {
            if (!val || val === 0) return '0';
            if (val >= 100000000) return `${(val / 100000000).toFixed(1)}억`;
            if (val >= 10000) return `${(val / 10000).toFixed(0)}만`;
            return val.toLocaleString();
        };

        const normalizeMonth = (str) => {
            if (!str) return '';
            let s = String(str).trim();
            if (s.startsWith('#') || s === '') return '';

            const ymdMatch = s.match(/(\d{4})[.\-/년]\s*(\d{1,2})/);
            if (ymdMatch) return `${ymdMatch[1]}-${ymdMatch[2].padStart(2, '0')}`;
            
            const monthMatch = s.match(/^(\d{1,2})(월)?$/);
            if (monthMatch) {
                const m = parseInt(monthMatch[1]);
                if (m >= 1 && m <= 12) return `2025-${String(m).padStart(2, '0')}`;
            }
            return s; 
        };

        const CHART_COLORS = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ec4899', '#6366f1', '#14b8a6', '#f43f5e'];
        // COLORS.target will be used for text, the gradient will be handled in render
        const COLORS = { revenue: '#10b981', target: '#f97316' }; 

        // --- MOCK DATA (기본값) ---
        const MOCK_SALES = [
            [null, '2025-01', '김철수', 'A고객사', '1', null, null, '50000000'],
            [null, '2025-02', '이영희', 'B고객사', '1', null, null, '70000000'],
            [null, '2025-03', '박민수', 'C고객사', '1', null, null, '120000000']
        ];
        const MOCK_ACTIVITY = [
            { person: '김철수', type: '아웃바운드' }, { person: '이영희', type: '메일 영업' },
            { person: '박민수', type: '미팅' }, { person: '최지수', type: '제안서 작성' },
            { person: '정다은', type: '콜드콜' }, { person: '강현우', type: '네트워킹' }
        ];
        // 목표 데이터 기본값 (1,8,12월: 1억 / 나머지: 2억)
        const MOCK_TARGETS = [
            ['1월', '100000000'], ['2월', '200000000'], ['3월', '200000000'],
            ['4월', '200000000'], ['5월', '200000000'], ['6월', '200000000'],
            ['7월', '200000000'], ['8월', '100000000'], ['9월', '200000000'],
            ['10월', '200000000'], ['11월', '200000000'], ['12월', '100000000']
        ];

        // Recharts Safe Wrapper
        const SafeRecharts = ({ render }) => {
            const [lib, setLib] = useState(window.Recharts);
            const [isTimeout, setIsTimeout] = useState(false);
            useEffect(() => {
                if (lib) return;
                const start = Date.now();
                const timer = setInterval(() => {
                    if (window.Recharts) { setLib(window.Recharts); clearInterval(timer); }
                    else if (Date.now() - start > 5000) { setIsTimeout(true); clearInterval(timer); }
                }, 100);
                return () => clearInterval(timer);
            }, [lib]);
            if (isTimeout) return <div className="flex h-full items-center justify-center text-xs text-red-400">차트 로딩 실패</div>;
            if (!lib) return <div className="flex h-full items-center justify-center text-xs text-slate-500 animate-pulse">차트 로딩...</div>;
            return render(lib);
        };

        // --- Data Editor Component ---
        const DataEditor = ({ activityData, salesData, targetData, colMap, onSave, onClose }) => {
            const [activeTab, setActiveTab] = useState('sales');
            const [localActivity, setLocalActivity] = useState([...activityData]);
            const [localSales, setLocalSales] = useState([...salesData]);
            const [localTargets, setLocalTargets] = useState([...targetData]);

            // Handlers
            const updateActivity = (idx, field, val) => {
                const newData = [...localActivity];
                newData[idx] = { ...newData[idx], [field]: val };
                setLocalActivity(newData);
            };
            const addActivity = () => setLocalActivity([...localActivity, { person: '', type: '' }]);
            const removeActivity = (idx) => setLocalActivity(localActivity.filter((_, i) => i !== idx));

            const updateSales = (idx, colIdx, val) => {
                const newData = [...localSales];
                while(newData[idx].length <= colIdx) newData[idx].push('');
                newData[idx][colIdx] = val;
                setLocalSales(newData);
            };
            const addSales = () => {
                const newRow = [];
                const maxIdx = Math.max(colMap.date, colMap.manager, colMap.client, colMap.count, colMap.revenue);
                for(let i=0; i<=maxIdx; i++) newRow.push('');
                newRow[colMap.date] = new Date().toISOString().slice(0, 7); 
                setLocalSales([...localSales, newRow]);
            }
            const removeSales = (idx) => setLocalSales(localSales.filter((_, i) => i !== idx));

            const updateTarget = (idx, colIdx, val) => {
                const newData = [...localTargets];
                while(newData[idx].length <= colIdx) newData[idx].push('');
                newData[idx][colIdx] = val;
                setLocalTargets(newData);
            };
            const addTarget = () => {
                const newRow = ['', ''];
                setLocalTargets([...localTargets, newRow]);
            }
            const removeTarget = (idx) => setLocalTargets(localTargets.filter((_, i) => i !== idx));

            const handleSave = () => {
                onSave(localActivity, localSales, localTargets);
            };

            return (
                <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-[100] backdrop-blur-sm p-4">
                    <div className="bg-slate-800 w-full max-w-4xl h-[80vh] rounded-lg shadow-2xl flex flex-col border border-slate-600">
                        <div className="flex justify-between items-center p-3 border-b border-slate-700 bg-slate-900/50 rounded-t-lg">
                            <div className="flex items-center gap-2">
                                <Icons.Edit className="text-blue-400" />
                                <h2 className="text-lg font-bold text-white">데이터 편집 모드</h2>
                            </div>
                            <button onClick={onClose} className="text-slate-400 hover:text-white transition-colors"><Icons.X /></button>
                        </div>
                        <div className="flex border-b border-slate-700 bg-slate-900/30">
                            <button onClick={() => setActiveTab('sales')} className={`px-4 py-3 text-sm font-bold flex items-center gap-2 transition-colors ${activeTab === 'sales' ? 'text-emerald-400 border-b-2 border-emerald-400 bg-slate-800' : 'text-slate-400 hover:text-slate-200'}`}><Icons.DollarSign size={14}/> Sales</button>
                            <button onClick={() => setActiveTab('activity')} className={`px-4 py-3 text-sm font-bold flex items-center gap-2 transition-colors ${activeTab === 'activity' ? 'text-blue-400 border-b-2 border-blue-400 bg-slate-800' : 'text-slate-400 hover:text-slate-200'}`}><Icons.Briefcase size={14}/> Activity</button>
                            <button onClick={() => setActiveTab('target')} className={`px-4 py-3 text-sm font-bold flex items-center gap-2 transition-colors ${activeTab === 'target' ? 'text-slate-200 border-b-2 border-slate-400 bg-slate-800' : 'text-slate-400 hover:text-slate-200'}`}><Icons.Target size={14}/> Target</button>
                        </div>
                        <div className="flex-1 overflow-auto p-4 bg-slate-800 text-white">
                             {/* ... Editor Content ... */}
                            {activeTab === 'sales' && (
                                <div>
                                    <table className="w-full text-sm text-left text-slate-400">
                                        <thead className="text-xs uppercase bg-slate-700 text-slate-200 sticky top-0"><tr><th className="px-3 py-2 w-24">날짜</th><th className="px-3 py-2">담당자</th><th className="px-3 py-2">고객사</th><th className="px-3 py-2 w-32">매출액</th><th className="px-3 py-2 text-center w-16">삭제</th></tr></thead>
                                        <tbody className="divide-y divide-slate-700">
                                            {localSales.map((row, idx) => (
                                                <tr key={idx} className="hover:bg-slate-700/50">
                                                    <td className="p-1"><input type="text" value={row[colMap.date] || ''} onChange={(e) => updateSales(idx, colMap.date, e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-emerald-500 outline-none" /></td>
                                                    <td className="p-1"><input type="text" value={row[colMap.manager] || ''} onChange={(e) => updateSales(idx, colMap.manager, e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-emerald-500 outline-none" /></td>
                                                    <td className="p-1"><input type="text" value={row[colMap.client] || ''} onChange={(e) => updateSales(idx, colMap.client, e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-emerald-500 outline-none" /></td>
                                                    <td className="p-1"><input type="text" value={row[colMap.revenue] || ''} onChange={(e) => updateSales(idx, colMap.revenue, e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-emerald-500 outline-none text-right" /></td>
                                                    <td className="p-1 text-center"><button onClick={() => removeSales(idx)} className="text-red-400 hover:text-red-300 p-1"><Icons.Trash size={14}/></button></td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    <button onClick={addSales} className="mt-3 flex items-center gap-1 text-xs text-emerald-400 hover:text-emerald-300 font-bold px-2 py-1 border border-emerald-900 bg-emerald-900/20 rounded"><Icons.Plus size={12}/> 행 추가</button>
                                </div>
                            )}
                            {activeTab === 'activity' && (
                                <div>
                                    <table className="w-full text-sm text-left text-slate-400">
                                        <thead className="text-xs uppercase bg-slate-700 text-slate-200 sticky top-0"><tr><th className="px-3 py-2">담당자</th><th className="px-3 py-2">활동 유형</th><th className="px-3 py-2 text-center w-16">삭제</th></tr></thead>
                                        <tbody className="divide-y divide-slate-700">
                                            {localActivity.map((item, idx) => (
                                                <tr key={idx} className="hover:bg-slate-700/50">
                                                    <td className="p-1"><input type="text" value={item.person || ''} onChange={(e) => updateActivity(idx, 'person', e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-blue-500 outline-none" /></td>
                                                    <td className="p-1"><input type="text" value={item.type || ''} onChange={(e) => updateActivity(idx, 'type', e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-blue-500 outline-none" /></td>
                                                    <td className="p-1 text-center"><button onClick={() => removeActivity(idx)} className="text-red-400 hover:text-red-300 p-1"><Icons.Trash size={14}/></button></td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    <button onClick={addActivity} className="mt-3 flex items-center gap-1 text-xs text-blue-400 hover:text-blue-300 font-bold px-2 py-1 border border-blue-900 bg-blue-900/20 rounded"><Icons.Plus size={12}/> 행 추가</button>
                                </div>
                            )}
                            {activeTab === 'target' && (
                                <div>
                                    <div className="mb-2 text-xs text-slate-500">* 날짜는 'YYYY-MM' 또는 'M월' 형식으로 입력하세요. (예: 2025-01, 1월)</div>
                                    <table className="w-full text-sm text-left text-slate-400">
                                        <thead className="text-xs uppercase bg-slate-700 text-slate-200 sticky top-0"><tr><th className="px-3 py-2 w-32">월 (Month)</th><th className="px-3 py-2">목표 금액</th><th className="px-3 py-2 text-center w-16">삭제</th></tr></thead>
                                        <tbody className="divide-y divide-slate-700">
                                            {localTargets.map((row, idx) => (
                                                <tr key={idx} className="hover:bg-slate-700/50">
                                                    <td className="p-1"><input type="text" value={row[0] || ''} onChange={(e) => updateTarget(idx, 0, e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-slate-400 outline-none" /></td>
                                                    <td className="p-1"><input type="text" value={row[1] || ''} onChange={(e) => updateTarget(idx, 1, e.target.value)} className="w-full bg-slate-900/50 border border-slate-600 rounded px-2 py-1 text-white focus:border-slate-400 outline-none text-right" placeholder="금액" /></td>
                                                    <td className="p-1 text-center"><button onClick={() => removeTarget(idx)} className="text-red-400 hover:text-red-300 p-1"><Icons.Trash size={14}/></button></td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    <button onClick={addTarget} className="mt-3 flex items-center gap-1 text-xs text-slate-400 hover:text-slate-300 font-bold px-2 py-1 border border-slate-700 bg-slate-800 rounded"><Icons.Plus size={12}/> 행 추가</button>
                                </div>
                            )}
                        </div>
                        <div className="p-3 border-t border-slate-700 bg-slate-900/50 rounded-b-lg flex justify-end gap-2">
                            <button onClick={onClose} className="px-4 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 rounded text-xs font-bold transition-colors">취소</button>
                            <button onClick={handleSave} className="px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded text-xs font-bold flex items-center gap-2 transition-colors shadow-lg shadow-blue-900/50"><Icons.Save size={14}/> 저장 및 적용</button>
                        </div>
                    </div>
                </div>
            );
        };

        function SalesDashboard() {
            // 초기값 = MOCK 데이터 (화면 꺼짐 방지)
            const [activityData, setActivityData] = useState(MOCK_ACTIVITY);
            const [salesData, setSalesData] = useState(MOCK_SALES);
            const [targetData, setTargetData] = useState(MOCK_TARGETS);
            
            const [isLiveSource, setIsLiveSource] = useState(false);
            const [isManual, setIsManual] = useState(false); // 수기 모드 여부
            
            // 디버깅용 Raw Data
            const [rawSales, setRawSales] = useState([]);
            const [rawTarget, setRawTarget] = useState([]);

            const [loading, setLoading] = useState(false);
            const [showSettings, setShowSettings] = useState(false);
            const [showEditor, setShowEditor] = useState(false);
            const [showRawInspector, setShowRawInspector] = useState(false);

            // 고정된 SHEET ID 및 GID
            const SHEET1_ID = '1W0OXOMzCvq6KlBwWpnnXQTgcOaC1gK4zftTEq5qmfns';
            const [activityGid, setActivityGid] = useState('0');
            const [salesGid, setSalesGid] = useState('1883872851');
            
            const SHEET2_ID = '1QK-HsCYzX3ke21LGfimauuUI8e6FPv2lEqTJWLJeaP0';
            const [targetGid, setTargetGid] = useState('224024511'); 
            
            // Activity Column Map
            const [actColMap, setActColMap] = useState({
                name: 2, // C열
                type: 3  // D열
            });

            // Sales Column Map
            const [colMap, setColMap] = useState({
                date: 0,      // A열 (Sales)
                manager: 2,   // C열 (Sales)
                client: 3,    // D열 (Sales)
                count: 4,     // E열 (Sales)
                revenue: 7    // H열 (Sales)
            });

            // URL 변환 로직 (pubhtml -> gviz URL)
            const getCsvUrl = (url, gid) => {
                if (!url) return "";
                let base = url;
                if (url.includes("pubhtml")) {
                    base = url.replace("pubhtml", "pub?output=csv");
                } else if (url.includes("edit")) {
                     base = url.replace(/\/edit.*$/, "/export?format=csv");
                }
                const separator = base.includes("?") ? "&" : "?";
                return `${base}${separator}gid=${gid}&single=true`;
            };

            // 데이터 로드
            const fetchAndParse = async (url) => {
                try {
                    const res = await fetch(url);
                    const text = await res.text();
                    // HTML 태그로 시작하면 실패로 간주 (권한 오류 등)
                    if (res.ok && !text.trim().startsWith('<')) {
                        const rows = parseCSV(text);
                        if (rows.length < 2) return null; 
                        return rows;
                    }
                } catch(e) { }
                return null;
            };

            const fetchData = useCallback(async () => {
                // 수기 모드면 패치 안함 (사용자 입력 보존)
                if (isManual) return;

                setLoading(true);
                // 중요: export format=csv 사용 - URL 기본값을 edit URL로 변경
                const getExportUrl1 = (gid) => `https://docs.google.com/spreadsheets/d/${SHEET1_ID}/export?format=csv&gid=${gid}`;
                
                let successCount = 0;

                // 1. Activity (Sheet 1)
                const actRows = await fetchAndParse(getExportUrl1(activityGid));
                if (actRows) {
                    const parsed = actRows.slice(1).map(r => ({ person: r[actColMap.name], type: r[actColMap.type] })).filter(r => r.person);
                    if(parsed.length > 0) { 
                        setActivityData(parsed); 
                        successCount++;
                    }
                }

                // 2. Sales (Sheet 1)
                const salesRows = await fetchAndParse(getExportUrl1(salesGid));
                if (salesRows) {
                    setRawSales(salesRows.slice(0, 5));
                    if (salesRows.length > 1) {
                        setSalesData(salesRows.slice(1));
                        successCount++;
                    }
                }
                
                // 3. Targets -> 패치 제거 (수기 입력 유지)

                if (successCount > 0) setIsLiveSource(true);
                else setIsLiveSource(false);

                setLoading(false);
            }, [activityGid, salesGid, actColMap, colMap, isManual]);

            useEffect(() => {
                fetchData();
                const timerId = setInterval(fetchData, 600000); 
                return () => clearInterval(timerId);
            }, [fetchData]);

            const handleApplySettings = () => {
                setTimeout(() => { fetchData(); setShowSettings(false); }, 100);
            };

            const handleEditorSave = (newActivity, newSales, newTargets) => {
                setActivityData(newActivity);
                setSalesData(newSales);
                setTargetData(newTargets);
                
                setIsManual(true); // 수동 모드 활성화 (자동 업데이트 방지)
                setShowEditor(false);
            };
            
            const resetToAuto = () => {
                if(confirm("수기 입력을 취소하고 구글 시트 데이터로 되돌리시겠습니까?")) {
                    setIsManual(false);
                    fetchData(); // 즉시 패치 시도
                }
            };
            
            const getGvizUrl = (sheetId, gid) => `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv&gid=${gid}`;

            // --- 데이터 가공 ---
            // 안전장치: 데이터가 비어있으면 Mock 데이터 사용 (화면 꺼짐 방지)
            const safeActivity = useMemo(() => (activityData && activityData.length > 0) ? activityData : MOCK_ACTIVITY, [activityData]);
            const safeSales = useMemo(() => (salesData && salesData.length > 0) ? salesData : MOCK_SALES, [salesData]);
            const safeTargets = useMemo(() => (targetData && targetData.length > 0) ? targetData : MOCK_TARGETS, [targetData]);

            const processedActivityGroups = useMemo(() => {
                const groups = {};
                safeActivity.forEach(item => {
                    if (!item) return;
                    const p = item.person;
                    const t = item.type ? item.type.trim() : '';
                    if (!p || !t || t === '기타') return; 
                    if (!groups[t]) groups[t] = {};
                    groups[t][p] = (groups[t][p] || 0) + 1;
                });
                return Object.keys(groups).map(type => {
                    const data = Object.entries(groups[type]).map(([name, count]) => ({ name, count })).sort((a, b) => b.count - a.count);
                    const totalCount = data.reduce((a, c) => a + c.count, 0);
                    return { type, data, totalCount };
                }).filter(g => g.totalCount > 0).sort((a, b) => b.totalCount - a.totalCount);
            }, [safeActivity]);

            const processedSales = useMemo(() => {
                const aggregated = {};
                safeSales.forEach(row => {
                    if (!row) return;
                    const manager = row[colMap.manager];
                    const revStr = row[colMap.revenue];
                    if (!manager) return;
                    if (!aggregated[manager]) aggregated[manager] = { 담당자: manager, 매출액: 0 };
                    if (revStr) aggregated[manager].매출액 += parseCurrency(revStr);
                });
                return Object.values(aggregated);
            }, [safeSales, colMap]);

            // **Monthly Target & Revenue**
            const processedMonthly = useMemo(() => {
                const dataMap = new Map();
                for (let i = 1; i <= 12; i++) {
                    const monthKey = `2025-${String(i).padStart(2, '0')}`;
                    dataMap.set(monthKey, { month: monthKey, target: 0, revenue: 0, rate: 0 });
                }
                
                // 1. Target Data 매핑 (수기)
                safeTargets.forEach(row => {
                    if (!row || row.length < 2) return;
                    const rawDate = row[0]; 
                    const key = normalizeMonth(rawDate); 
                    if(!key) return;
                    const targetVal = parseCurrency(row[1]); 
                    if (dataMap.has(key)) dataMap.get(key).target = targetVal;
                });

                // 2. Sales Data 매핑 (자동)
                safeSales.forEach(row => {
                    if (!row) return;
                    const rawDate = row[colMap.date];
                    const key = normalizeMonth(rawDate);
                    if (!key) return;
                    const revVal = parseCurrency(row[colMap.revenue]);
                    if (dataMap.has(key)) dataMap.get(key).revenue += revVal;
                });

                // 3. 달성률
                return Array.from(dataMap.values())
                    .sort((a, b) => a.month.localeCompare(b.month))
                    .map(d => ({ ...d, rate: d.target > 0 ? (d.revenue / d.target * 100) : 0 }));
            }, [safeTargets, safeSales, colMap]);

            const chartData = useMemo(() => processedSales.filter(d => d.매출액 > 0), [processedSales]);
            const topSales = useMemo(() => [...processedSales].filter(d => d.매출액 > 0).sort((a, b) => b.매출액 - a.매출액).slice(0, 3), [processedSales]);
            const totalRevenue = useMemo(() => processedSales.reduce((acc, curr) => acc + curr.매출액, 0), [processedSales]);
            const totalTarget = useMemo(() => processedMonthly.reduce((acc, curr) => acc + curr.target, 0), [processedMonthly]);

            // --- 렌더러 ---
            const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, LabelList, Legend, Cell, Defs, LinearGradient, Stop } = window.Recharts;
            
            const renderActivityChart = (group, idx) => (
                <ResponsiveContainer width="100%" height="100%">
                    <BarChart data={group.data} margin={{ top: 15, right: 10, left: -10, bottom: 0 }}>
                        <CartesianGrid strokeDasharray="3 3" stroke="#334155" vertical={false} />
                        <XAxis dataKey="name" stroke="#94a3b8" tick={{fontSize: 11, fontWeight: 'bold', fill: '#ffffff'}} interval={0} />
                        <YAxis stroke="#94a3b8" tick={{fontSize: 10, fill: '#ffffff'}} />
                        <Tooltip cursor={{fill: '#334155', opacity: 0.2}} contentStyle={{ backgroundColor: '#1e293b', borderColor: '#334155', fontSize: '11px', color: '#fff' }} />
                        <Bar dataKey="count" fill={CHART_COLORS[idx % CHART_COLORS.length]} radius={[3, 3, 0, 0]} maxBarSize={30}><LabelList dataKey="count" content={({x,y,width,value})=>value?<text x={x+width/2} y={y-3} fill="#fff" textAnchor="middle" fontSize={11} fontWeight="bold">{value}</text>:null} /></Bar>
                    </BarChart>
                </ResponsiveContainer>
            );

            const renderRevenueChart = () => {
                // 데이터가 없을 때 안전장치
                if (!chartData || chartData.length === 0) {
                    return <div className="flex h-full items-center justify-center text-xs text-slate-500">데이터 없음 (컬럼 설정 확인)</div>;
                }
                return (
                    <ResponsiveContainer width="100%" height="100%">
                        <BarChart data={chartData.filter(d=>d.매출액>0).sort((a,b)=>b.매출액-a.매출액)} margin={{ top: 20, right: 10, left: 10, bottom: 0 }}>
                            <CartesianGrid strokeDasharray="3 3" stroke="#334155" vertical={false} />
                            <XAxis dataKey="담당자" stroke="#94a3b8" tick={{fontSize: 11, fontWeight: 'bold', fill: '#ffffff'}} interval={0} />
                            <YAxis stroke="#94a3b8" tick={{fontSize: 10, fill: '#ffffff'}} tickFormatter={v=>v>=10000?`${v/10000}만`:v} />
                            <Tooltip cursor={{fill: '#334155', opacity: 0.2}} contentStyle={{ backgroundColor: '#1e293b', borderColor: '#334155', fontSize: '11px', color: '#fff' }} formatter={(val) => val.toLocaleString()} />
                            <Bar dataKey="매출액" fill={COLORS.revenue} radius={[4, 4, 0, 0]} maxBarSize={40}><LabelList dataKey="매출액" content={({x,y,width,value})=>value?<text x={x+width/2} y={y-5} fill="#fff" textAnchor="middle" fontSize={11} fontWeight="bold">{formatKoreanCurrency(value)}</text>:null} /></Bar>
                        </BarChart>
                    </ResponsiveContainer>
                );
            };

            const renderMonthlyChart = () => (
                <ResponsiveContainer width="100%" height="100%">
                    <BarChart data={processedMonthly} margin={{ top: 20, right: 10, left: 10, bottom: 5 }}>
                        <defs>
                            <linearGradient id="targetGradient" x1="0" y1="0" x2="0" y2="1">
                                <stop offset="0%" stopColor="#22c55e" stopOpacity={1}/>
                                <stop offset="100%" stopColor="#3b82f6" stopOpacity={1}/>
                            </linearGradient>
                            <linearGradient id="colorGradient" x1="0" y1="0" x2="0" y2="1">
                                <stop offset="5%" stopColor="#22c55e" stopOpacity={0.9}/><stop offset="95%" stopColor="#3b82f6" stopOpacity={0.9}/>
                            </linearGradient>
                        </defs>
                        <CartesianGrid strokeDasharray="3 3" stroke="#334155" vertical={false} />
                        <XAxis dataKey="month" stroke="#94a3b8" tick={{fontSize: 11, fill:'#ffffff'}} tickFormatter={v=>`${parseInt(v.split('-')[1])}월`} />
                        <YAxis stroke="#94a3b8" tick={{fontSize: 10, fill:'#ffffff'}} tickFormatter={v=>v>=100000000?`${v/100000000}억`:`${v/10000}만`} />
                        <Tooltip cursor={{fill: '#334155', opacity: 0.2}} contentStyle={{ backgroundColor: '#1e293b', borderColor: '#334155', fontSize: '11px', color: '#fff' }} formatter={(val) => val.toLocaleString()} />
                        <Legend wrapperStyle={{fontSize:'11px', paddingTop:'5px'}}/>
                        <Bar name="목표" dataKey="target" fill="url(#targetGradient)" radius={[4, 4, 0, 0]} maxBarSize={20} />
                        <Bar name="매출" dataKey="revenue" radius={[4, 4, 0, 0]} maxBarSize={20}>
                            {processedMonthly.map((e, i) => {
                                let c = "#3b82f6"; 
                                if (e.rate <= 30) c = "#ef4444"; 
                                else if (e.rate <= 70) c = "#f97316"; 
                                else if (e.rate > 100) c = "url(#colorGradient)";
                                return <Cell key={`cell-${i}`} fill={c} />;
                            })}
                        </Bar>
                    </BarChart>
                </ResponsiveContainer>
            );

            return (
                <div className="h-full w-full flex flex-col overflow-hidden text-slate-100 font-sans bg-slate-900 fade-in">
                    <div className="h-12 bg-slate-800 border-b border-slate-700 px-4 flex items-center justify-between shrink-0">
                        <div className="flex items-center gap-3"><Icons.LayoutDashboard size={20} className="text-blue-500" /><h1 className="text-lg font-bold text-white tracking-wide">Sales Command Center</h1></div>
                        <div className="flex items-center gap-3">
                            <span className="text-xs text-slate-400 mr-2 hidden sm:block font-medium">자동 업데이트: 매일 18:10</span>
                            {/* Status Indicator */}
                            <div className={`flex items-center gap-1 px-2 py-1 rounded text-xs font-bold border ${isManual ? 'bg-blue-600/20 border-blue-500/50 text-blue-400' : (isLiveSource ? 'bg-emerald-600/20 border-emerald-500/50 text-emerald-400' : 'bg-amber-600/20 border-amber-500/50 text-amber-400')}`}>
                                {isManual ? <Icons.Lock size={14}/> : (isLiveSource ? <Icons.Check size={14}/> : <Icons.AlertTriangle size={14}/>)}
                                {isManual ? '수기 모드 (잠금)' : (isLiveSource ? 'Live Data' : 'Check Source')}
                            </div>
                            <div className="h-5 w-[1px] bg-slate-600 mx-1"></div>
                            {isManual && <button onClick={resetToAuto} className="text-xs text-slate-400 hover:text-white underline mr-2">수동 해제</button>}
                            <button onClick={()=>setShowEditor(true)} className="flex items-center gap-1 text-slate-300 hover:text-white px-2 py-1 hover:bg-slate-700 rounded transition-colors" title="데이터 수정"><Icons.Edit size={16} /><span className="text-xs font-bold">수정</span></button>
                            <button onClick={()=>setShowSettings(!showSettings)} className="text-slate-300 hover:text-white p-1 hover:bg-slate-700 rounded"><Icons.Settings size={18} /></button>
                            <button onClick={fetchData} className={`text-slate-300 hover:text-white p-1 hover:bg-slate-700 rounded ${loading?'animate-spin':''}`}><Icons.RefreshCw size={18} /></button>
                        </div>
                    </div>

                    {showEditor && <DataEditor activityData={activityData} salesData={salesData} targetData={targetData} colMap={colMap} onSave={handleEditorSave} onClose={() => setShowEditor(false)} />}

                    {showSettings && (
                        <div className="absolute top-14 right-4 z-50 w-[500px] bg-slate-800 border border-slate-600 rounded shadow-2xl p-4 text-sm slide-in flex flex-col max-h-[80vh] overflow-hidden">
                            <div className="flex justify-between mb-3 shrink-0"><span className="font-bold text-base text-white">데이터 설정 및 미리보기</span><button onClick={() => setShowSettings(false)}><Icons.X size={18}/></button></div>
                            <div className="flex gap-2 mb-3 shrink-0 border-b border-slate-700 pb-2">
                                <button onClick={()=>setShowRawInspector(false)} className={`px-3 py-1 rounded ${!showRawInspector ? 'bg-blue-600 text-white' : 'text-slate-400'}`}>매핑 설정</button>
                                <button onClick={()=>setShowRawInspector(true)} className={`px-3 py-1 rounded flex items-center gap-1 ${showRawInspector ? 'bg-blue-600 text-white' : 'text-slate-400'}`}><Icons.Eye size={12}/> 데이터 미리보기</button>
                            </div>
                            <div className="flex-1 overflow-auto">
                                {!showRawInspector ? (
                                    <>
                                        <div className="mb-3"><label className="block text-slate-400 text-xs mb-1">Sheet 1 (Activity/Sales) ID</label><input type="text" value={SHEET1_ID} readOnly className="w-full bg-slate-700 border border-slate-600 rounded px-2 py-2 text-slate-400" /></div>
                                        
                                        <div className="mb-3"><label className="block text-slate-400 text-xs mb-1">Activity GID (Sheet 1)</label><input type="text" value={activityGid} onChange={(e) => setActivityGid(e.target.value)} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-2 text-white" /></div>
                                        <div className="mb-3"><label className="block text-slate-400 text-xs mb-1">Sales GID (Sheet 1)</label><input type="text" value={salesGid} onChange={(e) => setSalesGid(e.target.value)} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-2 text-white" /></div>
                                        <div className="mb-3"><p className="text-slate-400 text-xs">* 목표 데이터는 [수정] 버튼을 눌러 직접 입력합니다.</p></div>
                                        
                                        <div className="grid grid-cols-2 gap-3 mb-4 border-t border-slate-700 pt-3">
                                            <div><label className="text-slate-400 text-xs block mb-1">Activity 이름 열</label><input type="number" value={actColMap.name} onChange={(e) => setActColMap({...actColMap, name: parseInt(e.target.value)})} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white"/></div>
                                            <div><label className="text-slate-400 text-xs block mb-1">Activity 유형 열</label><input type="number" value={actColMap.type} onChange={(e) => setActColMap({...actColMap, type: parseInt(e.target.value)})} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white"/></div>
                                            <div><label className="text-slate-400 text-xs block mb-1">Sales 날짜 열</label><input type="number" value={colMap.date} onChange={(e) => setColMap({...colMap, date: parseInt(e.target.value)})} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white"/></div>
                                            <div><label className="text-slate-400 text-xs block mb-1">Sales 담당자 열</label><input type="number" value={colMap.manager} onChange={(e) => setColMap({...colMap, manager: parseInt(e.target.value)})} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white"/></div>
                                            <div><label className="text-slate-400 text-xs block mb-1">Sales 매출액 열</label><input type="number" value={colMap.revenue} onChange={(e) => setColMap({...colMap, revenue: parseInt(e.target.value)})} className="w-full bg-slate-900 border border-slate-600 rounded px-2 py-1 text-white"/></div>
                                        </div>
                                        <button onClick={handleApplySettings} className="w-full bg-blue-600 py-2 rounded text-white font-bold text-sm hover:bg-blue-500">설정 적용 및 데이터 다시 불러오기</button>
                                    </>
                                ) : (
                                    <div className="space-y-4">
                                        <div>
                                            <h4 className="text-emerald-400 font-bold mb-2 text-xs">Sales Data (Top 5)</h4>
                                            <div className="overflow-x-auto bg-slate-900 p-2 rounded border border-slate-700">
                                                <table className="text-[10px] w-full text-left text-slate-300"><tbody>
                                                    {rawSales.length > 0 ? rawSales.map((row, i) => (<tr key={i} className="border-b border-slate-800"><td className="p-1 text-slate-500">{i}</td>{row.map((cell, j) => <td key={j} className="p-1 border-r border-slate-800 truncate max-w-[60px]" title={cell}>{cell}</td>)}</tr>)) : <tr><td className="p-2 text-slate-500">데이터 없음 (데모모드 또는 로딩 실패)</td></tr>}
                                                </tbody></table>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    <div className="flex-1 p-3 overflow-hidden grid grid-cols-12 gap-3">
                        <div className="col-span-3 bg-slate-800/40 border border-slate-700/50 rounded-xl p-3 flex flex-col h-full overflow-hidden shadow-lg">
                            <div className="flex items-center gap-2 mb-2 text-blue-400 font-bold text-base shrink-0 border-b border-slate-700/50 pb-2"><Icons.Briefcase size={16}/> Daily Activities</div>
                            <div className="flex-1 flex flex-col gap-2 overflow-hidden">
                                {processedActivityGroups.length > 0 ? processedActivityGroups.map((g, i) => (
                                    <div key={g.type} className="flex-1 min-h-0 bg-slate-900/40 rounded-lg p-2 flex flex-col border border-slate-700/30">
                                        <span className="text-xs font-bold text-slate-200 flex items-center gap-2 mb-1 px-1 shrink-0"><Icons.Layers size={12} style={{color:CHART_COLORS[i%8]}}/> {g.type} <span className="text-slate-400 font-normal">({g.totalCount})</span></span>
                                        <div className="flex-1 min-h-0"><SafeRecharts render={(r) => renderActivityChart(g, i, r)} /></div>
                                    </div>
                                )) : <div className="flex-1 flex items-center justify-center text-sm text-slate-500">데이터 없음</div>}
                            </div>
                        </div>

                        <div className="col-span-9 flex flex-col gap-3 h-full">
                            <div className="h-[25%] grid grid-cols-2 gap-3">
                                <div className="bg-slate-800/40 border border-slate-700/50 rounded-xl p-3 flex flex-col min-h-0 shadow-lg">
                                    <div className="flex items-center gap-2 mb-1 text-emerald-400 font-bold text-base"><Icons.DollarSign size={16}/> Revenue Status <span className="text-white ml-1 text-sm">[총 매출 {formatKoreanCurrency(totalRevenue)}원]</span></div>
                                    <div className="flex-1"><SafeRecharts render={renderRevenueChart} /></div>
                                </div>
                                <div className="bg-slate-800/40 border border-slate-700/50 rounded-xl flex flex-col overflow-hidden shadow-lg">
                                    <div className="h-8 px-3 flex items-center gap-2 bg-slate-700/30 border-b border-slate-700/50 text-yellow-400 font-bold text-base"><Icons.Crown size={16}/> Sales Top 3</div>
                                    <div className="flex-1 overflow-auto p-1">
                                        <table className="w-full text-xs text-left text-slate-300">
                                            <thead className="bg-slate-700/50 text-slate-100 sticky top-0 font-bold"><tr><th className="p-2 text-center w-12">순위</th><th className="p-2">담당자</th><th className="p-2 text-right">매출액</th></tr></thead>
                                            <tbody className="divide-y divide-slate-700/30 text-sm">
                                                {topSales.map((r, i) => (
                                                    <tr key={i} className="hover:bg-slate-700/30">
                                                        <td className="p-2 text-center font-bold text-yellow-400">{i+1}</td><td className="p-2 text-white font-bold">{r.담당자}</td><td className="p-2 text-right font-mono text-emerald-400 font-bold">{formatKoreanCurrency(r.매출액)}</td>
                                                    </tr>
                                                ))}
                                                {topSales.length === 0 && <tr><td colSpan="3" className="p-4 text-center text-slate-500">데이터 없음</td></tr>}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div className="h-[30%] bg-slate-800/40 border border-slate-700/50 rounded-xl p-3 flex flex-col min-h-0 shadow-lg">
                                <div className="flex items-center justify-between mb-1 px-1">
                                    <div className="flex items-center gap-2 text-orange-400 font-bold text-base"><Icons.Target size={16} className="text-orange-400"/> Monthly Target Status <span className="text-slate-400 text-sm font-normal ml-1">(현재: {formatKoreanCurrency(totalRevenue)} / 목표: {formatKoreanCurrency(totalTarget)})</span></div>
                                    <span className="text-xs text-slate-400">단위: 원 (목표)</span>
                                </div>
                                <div className="flex-1"><SafeRecharts render={renderMonthlyChart} /></div>
                            </div>

                            <div className="flex-1 bg-slate-800/40 border border-slate-700/50 rounded-xl flex flex-col overflow-hidden shadow-lg">
                                <div className="h-10 px-4 flex items-center justify-between bg-slate-700/30 border-b border-slate-700/50">
                                    <div className="flex items-center gap-2 text-indigo-400 font-bold text-base"><Icons.Building size={18}/> 나라장터 입찰 및 지원사업</div>
                                    <button className="text-xs bg-indigo-500/20 hover:bg-indigo-500/40 text-indigo-300 px-3 py-1.5 rounded transition-colors font-bold">새로고침</button>
                                </div>
                                <div className="flex-1 p-4 overflow-auto">
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 h-full">
                                        <div className="bg-slate-900/40 rounded-lg p-3 border border-slate-700/50 flex flex-col h-full"><h3 className="text-sm text-slate-300 font-bold mb-3 border-b border-slate-700 pb-2">입찰 공고 (최근 5건)</h3>
                                            <ul className="space-y-3 text-sm text-slate-300 flex-1 overflow-auto">
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">2025년도 정보시스템 유지관리 사업</span><span className="text-amber-500 font-bold ml-3 shrink-0">D-2</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">공공데이터 개방 및 품질진단 용역</span><span className="text-slate-400 font-bold ml-3 shrink-0">D-5</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">스마트 시티 통합 플랫폼 구축</span><span className="text-slate-400 font-bold ml-3 shrink-0">D-7</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">지능형 교통체계(ITS) 구축 사업</span><span className="text-slate-400 font-bold ml-3 shrink-0">D-10</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors"><span className="truncate flex-1 font-medium">차세대 지방세정보시스템 유지관리</span><span className="text-slate-400 font-bold ml-3 shrink-0">D-12</span></li>
                                            </ul>
                                        </div>
                                        <div className="bg-slate-900/40 rounded-lg p-3 border border-slate-700/50 flex flex-col h-full"><h3 className="text-sm text-slate-300 font-bold mb-3 border-b border-slate-700 pb-2">지원사업 공고 (추천)</h3>
                                            <ul className="space-y-3 text-sm text-slate-300 flex-1 overflow-auto">
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">AI 바우처 지원사업 수요기업 모집</span><span className="text-emerald-500 font-bold ml-3 shrink-0">접수중</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">데이터 바우처 지원사업 하반기</span><span className="text-red-400 font-bold ml-3 shrink-0">마감임박</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">클라우드 바우처 수요기업 모집</span><span className="text-emerald-500 font-bold ml-3 shrink-0">접수중</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors border-b border-slate-800/50"><span className="truncate flex-1 font-medium">비대면 서비스 바우처 플랫폼</span><span className="text-slate-400 font-bold ml-3 shrink-0">예정</span></li>
                                                <li className="flex justify-between hover:bg-slate-800 p-2 rounded cursor-pointer transition-colors"><span className="truncate flex-1 font-medium">스마트 공방 기술보급 사업</span><span className="text-slate-400 font-bold ml-3 shrink-0">예정</span></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SalesDashboard />);
    </script>
</body>
</html>
